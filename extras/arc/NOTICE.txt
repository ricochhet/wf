Based on https://github.com/jm33-m0/arc